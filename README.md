# Pi Expenses AMOLED
UI #000000 para AMOLED, acentos estilo Bootstrap, Google Sign-in, presupuestos por quincena, carga de comprobantes (foto) a Supabase Storage y PWA.

## Supabase
1) Activa Google en Auth → Providers. Redirect: `https://<PROJECT-REF>.supabase.co/auth/v1/callback`.
2) Variables `.env.local`: `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`, `NEXT_PUBLIC_SUPABASE_BUCKET=receipts`.
3) SQL:
```sql
create table if not exists expenses (
  id bigint generated by default as identity primary key,
  user_id uuid not null,
  when_date date not null,
  description text not null,
  category text,
  amount numeric not null,
  paid boolean not null default false,
  receipt_url text,
  inserted_at timestamptz default now()
);
alter table expenses enable row level security;
create policy "exp: owner all" on expenses
  for all using (auth.uid() = user_id) with check (auth.uid() = user_id);

create table if not exists budgets (
  id bigint generated by default as identity primary key,
  user_id uuid not null,
  year int not null,
  month int not null,
  quincena int not null check (quincena in (1,2)),
  amount numeric not null,
  note text,
  inserted_at timestamptz default now(),
  unique (user_id, year, month, quincena)
);
alter table budgets enable row level security;
create policy "bud: owner all" on budgets
  for all using (auth.uid() = user_id) with check (auth.uid() = user_id);
```
Opcional RPC:
```sql
create or replace function summary_monthly()
returns table(label text, total numeric)
language sql stable as $$
  select to_char(when_date,'YYYY-MM') as label, sum(amount) total
  from expenses where user_id=auth.uid() group by 1 order by 1;
$$;
create or replace function summary_categories()
returns table(category text, total numeric)
language sql stable as $$
  select coalesce(category,'Sin categoría') category, sum(amount) total
  from expenses where user_id=auth.uid() group by 1 order by 1;
$$;
```
## Storage
Crea bucket `receipts`. Si es público es más simple; si lo haces privado, usa URLs firmadas desde el cliente.

## Dev
```bash
cp .env.example .env.local
npm i
npm run dev
```
